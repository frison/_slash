---
layout: article
title: BSD-Curious
author: Brett Kosinski
date: 2010-03-02 02:00:00 -0700
category: [ hacking ]
no_fediverse: true
---

So for no particular reason at all, I recently got the urge to try out a BSD variant on my laptop.  Now, historically I've been a die-hard Linux user, having cut my teeth on Slackware back when you needed dozens of floppies to install the thing (as a quick aside, I didn't have internet access at home at the time, and so I used a PC at school to download Slack from a local BBS, which meant trucking dozens of floppies there and back... which was really fun when, say, disk 12 of 20-something had a bad sector, requiring me to return to school the next day (leaving the install process up and in limbo in the mean time) to write out a new disk).  Since then, I've worked with Redhat, Debian, Fedora, and Ubuntu, but have never strayed outside the realm of Linux, and so, in a fit of boredom, I decided to address that little shortcoming in my technical upbringing.

Of course, there are multiple BSDs out there, each with their own focus and vision, and chosing one is often a matter of taste.  My initial choice was [FreeBSD](http://www.freebsd.org), which I threw on a 10GB partition on my laptop, after which I found myself facing the familiar command prompt (well, not quite familiar... it was straight sh instead of bash, which was... annoying), and a fairly barebones system.  At this point I discovered an important difference between the BSDs and, say, Ubuntu:  out of the box, they tend to provide a very bare-bones system, enough to get you bootstrapped so you can build the system you need.  But **you** have to build it.  Not that I mind, I'm a tinkerer at heart.

I then spent the next couple days fiddling around with the system and configuring it as necessary, which was a very different experience from what you see in Linux.  You see, in FreeBSD (and NetBSD, which I'll get to later), the primary system configuration, which includes network configuration, system daemon selection, and so forth, is all stored in a single file in etc called 'rc.conf'.  In contrast, Linux distros tend to manage things in varying ways, which means you to need to learn individual platform quirks and tools, something which is always a bit tedious.  And so, by playing with the rc.conf, I was easily able to get networking up and running, including my wireless card, various system daemons, and so forth.  And after that, it was off to install some interesting programs.

And this was where I discovered my next surprise.  In the Linux world, package managers are really king, with two main contenders vying for the top spot:  deb and rpm.  Of course, there are a few outliers (Slackware's tgz's, Gentoo's portage system, etc), but for the most part, modern distros are based on one of these two package management systems.  Not so with FreeBSD.  FBSD uses a system called 'ports', which should be familiar to a Gentoo user, as portage is really a rip-off of ports.  In essence, ports is a gigantic set of scripts, where each supported application is represented by a directory containing Makefiles, patches, and so forth, which can be used to install the application.  A simple 'make install' in the directory results in the source for the package being downloaded, patched, configured, built, and installed.  It's really quite slick, if you're interested in building everything from source (which can take quite a while).  Of course, FBSD also has binary package support, but building from ports is the most common way people install software in the FBSD world.

Unfortunately, I finally hit a brick wall with FBSD on my laptop when I attempted to suspend it.  Big mistake.  You see, it turns out that, even now, with FreeBSD 8.0, support for suspend/resume is incredibly weak.  So while Linux has stumbled along and finally reached a point where things kinda sorta work most of the time, FBSD is, I'd wager, at least 5 years behind.  Which is a real shame, as I use suspend **all the time** with my laptop.  And thus it was that FBSD as a possible OS alternative was nixed.

So, what next?  Well, in my mind, the most obvious alternative contender was [NetBSD](http://www.netbsd.org) (I eventually chose the 32-bit version for reasons I won't get in to here).  Like FreeBSD, NetBSD installs to a very barebones system, though even **more** barebones than FBSD, if that can be believed.  In fact, the ISO for the installation media is a mere 250MB, give or take, which is pretty diminutive beside FBSD's 2GB DVD image (though, to be fair, FBSD's DVD ships with a ton of pre-compiled packages, while NetBSD leaves you having to download all that software from the intertubes).  Similar to FBSD, the entire system is configured through /etc/rc.conf, and basic configuration was equally easy.  Once that was done, again my thoughts turned to software.

The NetBSD package system shares a lot of commonalities with the FreeBSD system.  Which shouldn't be surprising because NetBSD's system, pkgsrc, was forked from ports back in *1997*.  As such, they share an underlying philosophy, and so the two systems operate very similarly.  I will say, though, that ports does have one significant advantage over pkgsrc:  Much better OS integration.  See, pkgsrc is really a sister project to NetBSD.  As such, it can actually be run on myriad operating systems, including Linux, among many others.  But that means that the system doesn't tie into the OS all that well.  So while a ports package, once built, will populate /etc/rc.conf will configuration values, throw itself into /usr/local/etc/rc.d, and so forth, a pkgsrc package requires the user to perform extra work to integrate the software into the OS.  Additionally, I do prefer the way ports actively prompts the user for configuration directives for packages that provide them, but that's probably just a matter of taste.

Of course, I once again made the mistake of investing a fair bit of time into installing packages before I decided to test out suspend, and once again I was disappointed, though somewhat less so (which is why NetBSD is still on my laptop).  Suspending the laptop worked flawlessly, and was **incredibly** fast.  Honestly, I've never seen a laptop go to sleep that quickly.  But on resume, oddly enough, my videocard doesn't get initialized properly (this is a known problem with nVidia graphics chips in general, and on my laptop model in particular).  On the other hand, everything else works perfectly (the OS is actually fully responsive under the hood, the display simply doesn't come on).  Some hacking got things sorta working, but not reliably, so for now suspend on NetBSD will have to wait.  But at least there appears to be a chance.

So for now I've decided to stick with NetBSD.  Naturally I expect there to be more problems and limitations (at minimum, I'll be stuck with nv as my X driver, as nVidia's binary blob isn't supported on NetBSD), and I doubt it'll displace my Ubuntu install, but it should be fun seeing if it can!

And quick aside:  I was very impressed to discover that both Free and NetBSD supported essentially all the hardware on my laptop, without exception (well, save for ACPI suspend, of course), straight out of the box.  Very nice!

